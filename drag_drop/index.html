<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Список задач с drag & drop</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
      <section class="tasks">
        <h1 class="tasks__title">To do list</h1>
        
        <ul class="tasks__list">
          <li class="tasks__item">learn HTML</li>
          <li class="tasks__item">learn CSS</li>
          <li class="tasks__item">learn JavaScript</li>
          <li class="tasks__item">learn PHP</li>
          <li class="tasks__item">stay alive</li>
        </ul>
      </section>
    </div>
<script>
 const tasksListElement = document.querySelector(`.tasks__list`);
const taskElements = tasksListElement.querySelectorAll(`.tasks__item`);

for (const task of taskElements) {
  task.draggable = true;
}

tasksListElement.addEventListener(`dragstart`, (evt) => {
  evt.target.classList.add(`selected`);
});

tasksListElement.addEventListener(`dragend`, (evt) => {
  evt.target.classList.remove(`selected`);
});

const getNextElement = (cursorPosition, currentElement) => {
  const currentElementCoord = currentElement.getBoundingClientRect();
  const currentElementCenter = currentElementCoord.y + currentElementCoord.height / 2;
  
  const nextElement = (cursorPosition < currentElementCenter) ?
    currentElement :
    currentElement.nextElementSibling;
  
  return nextElement;
};

tasksListElement.addEventListener(`dragover`, (evt) => {
  evt.preventDefault();
  
  const activeElement = tasksListElement.querySelector(`.selected`);
  const currentElement = evt.target;
  const isMoveable = activeElement !== currentElement &&
    currentElement.classList.contains(`tasks__item`);
    
  if (!isMoveable) {
    return;
  }
  
  const nextElement = getNextElement(evt.clientY, currentElement);
  
  if (
    nextElement && 
    activeElement === nextElement.previousElementSibling ||
    activeElement === nextElement
  ) {
    return;
  }
		
	tasksListElement.insertBefore(activeElement, nextElement);
});
   
    
</script>
</body>
</html>

